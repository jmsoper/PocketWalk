<!DOCTYPE html>
<html>
  <head>
    <title>PocketWalk</title>
    <%= csrf_meta_tags %>
    <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>
  </head>

  <body>
    <div id="panel">
      <b>Mode of Travel: </b>
      <select id="mode" onchange="calcRoute();">
        <option value="DRIVING">Driving</option>
        <option value="WALKING">Walking</option>
        <option value="BICYCLING">Bicycling</option>
        <option value="TRANSIT">Transit</option>
      </select>
    </div>
    <div class="openpanel" id="littlearrow"></div>
    <div id="map-canvas" style="float:left;width:100%;height:100%;z-index:0;"></div>
  <section id="column" style="z-index:10;">
    <div id="control_panel" style="float:left;text-align:left;padding-top:20px;z-index:9;" class="panel">
    <div style="margin:20px;border-width:2px;" class="panel" id="incdirection">
      <div id="nav">
        <% if current_user %>
          <%= link_to "Edit Profile", edit_user_path(current_user.id) %>
          <%= link_to "Logout", :logout, method: :post %>
          <p>Welcome, <span><%= link_to current_user.username, user_path(current_user.id) %></span></p>
        <% else %>
          <%= link_to "Register", new_user_path %> |
          <%= link_to "Login", :login %>
        <% end %>
      </div>
      <div>
        <p id="notice"><%= flash[:notice] %></p>
        <p id="alert"><%= flash[:alert] %></p>
      </div>
      <%= yield %>
        <p class="help">?</p>
  </div>

  <img src="mapicon.png" class="mapicon">
  <div id="directions_panel" class="panel"></div>
  <div class="button" id="returnbutton"><p>reset tour</p></div>
  </div>
</section>
  </body>
</html>
<script src="//maps.google.com/maps/api/js?key=AIzaSyCP5DOPPvPGrmwBPLHyMgwPp8nWirQt7os"></script>
<script src="//cdn.rawgit.com/mahnunchik/markerclustererplus/master/dist/markerclusterer.min.js"></script>
<script src='//cdn.rawgit.com/printercu/google-maps-utility-library-v3-read-only/master/infobox/src/infobox_packed.js' type='text/javascript'></script>
<script type="text/javascript">
  handler = Gmaps.build('Google');

  handler.buildMap({ provider: {}, internal: {id: 'map-canvas'}}, function(){
    markers = handler.addMarkers(<%=raw @user_location_hash.to_json %>);
    handler.bounds.extendWith(markers);
    handler.fitMapToBounds();
  });
</script>
